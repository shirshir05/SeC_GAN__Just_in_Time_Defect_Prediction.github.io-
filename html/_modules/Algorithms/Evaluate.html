
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Algorithms.Evaluate &#8212; SeC-GAN 1.1 documentation</title>
    <link rel="stylesheet" href="../../static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../" src="../../static/documentation_options.js"></script>
    <script src="../../static/jquery.js"></script>
    <script src="../../static/underscore.js"></script>
    <script src="../../static/doctools.js"></script>
    <script src="../../static/language_data.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for Algorithms.Evaluate</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="kn">import</span> <span class="nn">sklearn.metrics</span> <span class="k">as</span> <span class="nn">metrics</span>
<span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>
<span class="kn">from</span> <span class="nn">sklearn.manifold</span> <span class="kn">import</span> <span class="n">TSNE</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">roc_curve</span><span class="p">,</span> <span class="n">precision_recall_curve</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">variable</span>

<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;/home/shir0/GAN_VS_RF&#39;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">Play</span> <span class="kn">import</span> <span class="n">play_algorithm</span> <span class="k">as</span> <span class="n">Play</span>


<span class="c1"># region define threshold</span>


<div class="viewcode-block" id="define_threshold_tesnsor"><a class="viewcode-back" href="../../Algorithms.html#Algorithms.Evaluate.define_threshold_tesnsor">[docs]</a><span class="k">def</span> <span class="nf">define_threshold_tesnsor</span><span class="p">(</span><span class="n">predictions_proba</span><span class="p">,</span> <span class="n">y_test</span><span class="p">):</span>
    <span class="c1"># # TODO: v1</span>
    <span class="c1"># fpr, tpr, thresholds = roc_curve(y_test, predictions_proba)</span>
    <span class="c1"># J = tpr - fpr</span>
    <span class="c1"># ix = np.argmax(J)</span>
    <span class="c1"># best_thresh = thresholds[ix]</span>
    <span class="c1"># predictions = np.where(predictions_proba &lt; best_thresh, 0, 1)</span>
    <span class="c1"># print(evaluate_on_test(y_test, predictions, None, predictions_proba, tensor=True))</span>

    <span class="c1"># # TODO: v2</span>
    <span class="c1"># gmean = np.sqrt(tpr * (1 - fpr))</span>
    <span class="c1"># index = np.argmax(gmean)</span>
    <span class="c1"># thresholdOpt = round(thresholds[index], ndigits=4)</span>
    <span class="c1"># predictions = np.where(predictions_proba &lt; thresholdOpt, 0, 1)</span>
    <span class="c1"># print(evaluate_on_test(y_test, predictions, None, predictions_proba, tensor=True))</span>

    <span class="c1"># TODO: v3 - 0.5</span>
    <span class="n">predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">predictions_proba</span> <span class="o">&lt;</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">evaluate_on_test</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predictions</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">predictions_proba</span><span class="p">,</span> <span class="n">tensor</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span></div>

    <span class="c1"># # TODO v4:</span>
    <span class="c1"># precision, recall, thresholds = precision_recall_curve(y_test, predictions_proba)</span>
    <span class="c1"># fscore = (2 * precision * recall) / (precision + recall)</span>
    <span class="c1"># index = np.argmax(fscore)</span>
    <span class="c1"># thresholdOpt = round(thresholds[index], ndigits=4)</span>
    <span class="c1"># predictions = np.where(predictions_proba &lt; thresholdOpt, 0, 1)</span>
    <span class="c1"># print(evaluate_on_test(y_test, predictions, None, predictions_proba, tensor=True))</span>


<div class="viewcode-block" id="define_threshold"><a class="viewcode-back" href="../../Algorithms.html#Algorithms.Evaluate.define_threshold">[docs]</a><span class="k">def</span> <span class="nf">define_threshold</span><span class="p">(</span><span class="n">classes</span><span class="p">,</span> <span class="n">predictions_proba</span><span class="p">,</span> <span class="n">y_test</span><span class="p">):</span>
    <span class="n">prob</span> <span class="o">=</span> <span class="n">predictions_proba</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="c1"># TODO: v1</span>
    <span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">thresholds</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">prob</span><span class="p">)</span>
    <span class="n">J</span> <span class="o">=</span> <span class="n">tpr</span> <span class="o">-</span> <span class="n">fpr</span>
    <span class="n">ix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>
    <span class="n">best_thresh</span> <span class="o">=</span> <span class="n">thresholds</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span>
    <span class="n">predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">prob</span> <span class="o">&lt;</span> <span class="n">best_thresh</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Max tpr - fpr&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">evaluate_on_test</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predictions</span><span class="p">,</span> <span class="n">classes</span><span class="p">,</span> <span class="n">predictions_proba</span><span class="p">))</span>

    <span class="c1"># TODO: v2</span>
    <span class="n">gmean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">tpr</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">fpr</span><span class="p">))</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">gmean</span><span class="p">)</span>
    <span class="n">thresholdOpt</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">thresholds</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">ndigits</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">prob</span> <span class="o">&lt;</span> <span class="n">thresholdOpt</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;tpr * (1 - fpr)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">evaluate_on_test</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predictions</span><span class="p">,</span> <span class="n">classes</span><span class="p">,</span> <span class="n">predictions_proba</span><span class="p">))</span>

    <span class="c1"># TODO: v3 - 0.5</span>
    <span class="n">predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">prob</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">0.5</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;0.5&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">evaluate_on_test</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predictions</span><span class="p">,</span> <span class="n">classes</span><span class="p">,</span> <span class="n">predictions_proba</span><span class="p">))</span>

    <span class="c1"># TODO v4:</span>
    <span class="n">precision</span><span class="p">,</span> <span class="n">recall</span><span class="p">,</span> <span class="n">thresholds</span> <span class="o">=</span> <span class="n">precision_recall_curve</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">prob</span><span class="p">)</span>
    <span class="n">fscore</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">precision</span> <span class="o">*</span> <span class="n">recall</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">precision</span> <span class="o">+</span> <span class="n">recall</span><span class="p">)</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">fscore</span><span class="p">)</span>
    <span class="n">thresholdOpt</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">thresholds</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">ndigits</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">prob</span> <span class="o">&lt;</span> <span class="n">thresholdOpt</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Max fscore&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">evaluate_on_test</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predictions</span><span class="p">,</span> <span class="n">classes</span><span class="p">,</span> <span class="n">predictions_proba</span><span class="p">))</span></div>


<span class="c1"># endregion</span>

<div class="viewcode-block" id="plot_old"><a class="viewcode-back" href="../../Algorithms.html#Algorithms.Evaluate.plot_old">[docs]</a><span class="k">def</span> <span class="nf">plot_old</span><span class="p">(</span><span class="n">nj</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">show_plot</span><span class="p">(</span><span class="n">list_values</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">list_values</span><span class="p">,</span> <span class="n">label</span><span class="p">):</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">l</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">project</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;epoch&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

    <span class="n">d_loss</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">NAME_PROJECT</span><span class="p">,</span> <span class="s2">&quot;Results&quot;</span><span class="p">,</span> <span class="s2">&quot;LOSS&quot;</span><span class="p">,</span> <span class="n">nj</span> <span class="o">+</span> <span class="s2">&quot;_real.csv&quot;</span><span class="p">),</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">show_plot</span><span class="p">([</span><span class="n">d_loss</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="s1">&#39;real&#39;</span><span class="p">],</span> <span class="s2">&quot;loss D&quot;</span><span class="p">)</span>

    <span class="n">g_loss</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">NAME_PROJECT</span><span class="p">,</span> <span class="s2">&quot;Results&quot;</span><span class="p">,</span> <span class="s2">&quot;LOSS&quot;</span><span class="p">,</span> <span class="n">nj</span> <span class="o">+</span> <span class="s2">&quot;_fake.csv&quot;</span><span class="p">),</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">show_plot</span><span class="p">([</span><span class="n">d_loss</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">g_loss</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="s1">&#39;real&#39;</span><span class="p">,</span> <span class="s1">&#39;fake&#39;</span><span class="p">],</span> <span class="s2">&quot;loss D&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="show_plot"><a class="viewcode-back" href="../../Algorithms.html#Algorithms.Evaluate.show_plot">[docs]</a><span class="k">def</span> <span class="nf">show_plot</span><span class="p">(</span><span class="n">list_values</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">list_values</span><span class="p">,</span> <span class="n">label</span><span class="p">):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">l</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">project</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;epoch&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span></div>


<div class="viewcode-block" id="plot"><a class="viewcode-back" href="../../Algorithms.html#Algorithms.Evaluate.plot">[docs]</a><span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="n">nj</span><span class="p">,</span> <span class="n">G</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">d_loss</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">NAME_PROJECT</span><span class="p">,</span> <span class="s2">&quot;Results&quot;</span><span class="p">,</span> <span class="s2">&quot;LOSS&quot;</span><span class="p">,</span> <span class="n">nj</span> <span class="o">+</span> <span class="s2">&quot;_D_loss.csv&quot;</span><span class="p">),</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                         <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">)])</span>
    <span class="n">average</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d_loss</span><span class="p">)</span>
    <span class="n">d_bug_real_loss</span> <span class="o">=</span> <span class="n">d_loss</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">d_valid_real_loss</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">d_loss</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
    <span class="n">d_bug_fake_nb_loss</span> <span class="o">=</span> <span class="n">d_loss</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">d_valid_fake_nb_loss</span> <span class="o">=</span> <span class="n">d_loss</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
    <span class="c1"># show_plot([d_bug_real_loss], [&quot;real&quot;], &quot;D loss predict bug data&quot;)</span>
    <span class="c1"># show_plot([d_valid_real_loss], [&quot;real&quot;], &quot;D loss valid data&quot;)</span>
    <span class="k">if</span> <span class="n">G</span><span class="p">:</span>
        <span class="n">g_nb_loss</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">NAME_PROJECT</span><span class="p">,</span> <span class="s2">&quot;Results&quot;</span><span class="p">,</span> <span class="s2">&quot;LOSS&quot;</span><span class="p">,</span> <span class="n">nj</span> <span class="o">+</span> <span class="s2">&quot;_G_nb.csv&quot;</span><span class="p">),</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)])</span>
        <span class="n">g_bug_fake_nb_loss</span> <span class="o">=</span> <span class="n">g_nb_loss</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">g_valid_fake_nb_loss</span> <span class="o">=</span> <span class="n">g_nb_loss</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

        <span class="n">g_b_loss</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">NAME_PROJECT</span><span class="p">,</span> <span class="s2">&quot;Results&quot;</span><span class="p">,</span> <span class="s2">&quot;LOSS&quot;</span><span class="p">,</span> <span class="n">nj</span> <span class="o">+</span> <span class="s2">&quot;_G_b.csv&quot;</span><span class="p">),</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                               <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)])</span>
        <span class="n">g_bug_fake_b_loss</span> <span class="o">=</span> <span class="n">g_b_loss</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">g_valid_fake_b_loss</span> <span class="o">=</span> <span class="n">g_b_loss</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

        <span class="c1"># show_plot([d_bug_fake_nb_loss, d_bug_fake_b_loss], [&quot;not bug&quot;, &quot;bug&quot;], &quot;D loss fake data&quot;)</span>
        <span class="c1"># show_plot([g_bug_fake_nb_loss, g_bug_fake_b_loss], [&quot;not bug&quot;, &quot;bug&quot;], &quot;G loss&quot;)</span>
        <span class="c1">#</span>
        <span class="c1"># show_plot([g_valid_fake_nb_loss, d_valid_fake_nb_loss[100:].reset_index()[4]], [&#39;G loss&#39;, &#39;D loss&#39;],</span>
        <span class="c1">#           &quot;G not bug fake/real&quot;)</span>
        <span class="c1"># show_plot([g_valid_fake_b_loss, d_valid_fake_b_loss[100:].reset_index()[6]], [&#39;G loss&#39;, &#39;D loss&#39;],</span>
        <span class="c1">#           &quot;G bug fake/real&quot;)</span>
        <span class="n">average</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">g_nb_loss</span><span class="p">)</span>
        <span class="n">average</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">g_b_loss</span><span class="p">)</span></div>


<div class="viewcode-block" id="evaluate_on_test"><a class="viewcode-back" href="../../Algorithms.html#Algorithms.Evaluate.evaluate_on_test">[docs]</a><span class="k">def</span> <span class="nf">evaluate_on_test</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">classes</span><span class="p">,</span> <span class="n">predicitons_proba</span><span class="p">,</span> <span class="n">tensor</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">pr_auc_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_score</span><span class="p">):</span>
        <span class="n">precision</span><span class="p">,</span> <span class="n">recall</span><span class="p">,</span> <span class="n">thresholds</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">precision_recall_curve</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_score</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">metrics</span><span class="o">.</span><span class="n">auc</span><span class="p">(</span><span class="n">recall</span><span class="p">,</span> <span class="n">precision</span><span class="p">)</span>

    <span class="n">scores</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="n">tensor</span><span class="p">:</span>
        <span class="n">y_prob_true</span> <span class="o">=</span> <span class="n">predicitons_proba</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">y_prob_true</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">classes</span><span class="p">,</span> <span class="n">predicitons_proba</span><span class="p">))[</span><span class="s1">&#39;1&#39;</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">y_prob_true</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">classes</span><span class="p">,</span> <span class="n">predicitons_proba</span><span class="p">))[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">scores</span><span class="p">[</span><span class="s1">&#39;f1_score&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">f1_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">scores</span><span class="p">[</span><span class="s1">&#39;precision_score&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">precision_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">scores</span><span class="p">[</span><span class="s1">&#39;recall_score&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">recall_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">scores</span><span class="p">[</span><span class="s1">&#39;roc_auc_score&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_prob_true</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">scores</span><span class="p">[</span><span class="s1">&#39;roc_auc_score&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_prob_true</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
    <span class="n">scores</span><span class="p">[</span><span class="s1">&#39;accuracy_score&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">scores</span><span class="p">[</span><span class="s1">&#39;pr_auc_score&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pr_auc_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">scores</span><span class="p">[</span><span class="s1">&#39;tn&#39;</span><span class="p">],</span> <span class="n">scores</span><span class="p">[</span><span class="s1">&#39;fp&#39;</span><span class="p">],</span> <span class="n">scores</span><span class="p">[</span><span class="s1">&#39;fn&#39;</span><span class="p">],</span> <span class="n">scores</span><span class="p">[</span><span class="s1">&#39;tp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span>
                                                              <span class="nb">list</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">())]</span>
    <span class="k">return</span> <span class="n">scores</span></div>


<div class="viewcode-block" id="plot_epochs_metric"><a class="viewcode-back" href="../../Algorithms.html#Algorithms.Evaluate.plot_epochs_metric">[docs]</a><span class="k">def</span> <span class="nf">plot_epochs_metric</span><span class="p">(</span><span class="n">hist</span><span class="p">,</span> <span class="n">file_name</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;loss&#39;</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hist</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="n">metric</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hist</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;val_&#39;</span> <span class="o">+</span> <span class="n">metric</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;model &#39;</span> <span class="o">+</span> <span class="n">metric</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">metric</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;large&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;epoch&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;large&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="s1">&#39;val&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


<div class="viewcode-block" id="save_logs"><a class="viewcode-back" href="../../Algorithms.html#Algorithms.Evaluate.save_logs">[docs]</a><span class="k">def</span> <span class="nf">save_logs</span><span class="p">(</span><span class="n">output_directory</span><span class="p">,</span> <span class="n">hist</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">y_true</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="n">lr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">y_true_val</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y_pred_val</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">hist_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">hist</span><span class="o">.</span><span class="n">history</span><span class="p">)</span>
    <span class="n">hist_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">output_directory</span> <span class="o">+</span> <span class="s1">&#39;history.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">y_pred</span> <span class="o">&lt;</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">df_metrics</span> <span class="o">=</span> <span class="n">evaluate_on_test</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">predictions</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">df_metrics</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">df_metrics</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
    <span class="c1"># df_metrics = calculate_metrics(y_true, y_pred, duration, y_true_val, y_pred_val)</span>
    <span class="n">df_metrics</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">output_directory</span> <span class="o">+</span> <span class="s1">&#39;df_metrics.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">index_best_model</span> <span class="o">=</span> <span class="n">hist_df</span><span class="p">[</span><span class="s1">&#39;loss&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()</span>
    <span class="n">row_best_model</span> <span class="o">=</span> <span class="n">hist_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">index_best_model</span><span class="p">]</span>

    <span class="n">df_best_model</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                 <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;best_model_train_loss&#39;</span><span class="p">,</span> <span class="s1">&#39;best_model_val_loss&#39;</span><span class="p">,</span> <span class="s1">&#39;best_model_train_acc&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;best_model_val_acc&#39;</span><span class="p">,</span> <span class="s1">&#39;best_model_learning_rate&#39;</span><span class="p">,</span> <span class="s1">&#39;best_model_nb_epoch&#39;</span><span class="p">])</span>

    <span class="n">df_best_model</span><span class="p">[</span><span class="s1">&#39;best_model_train_loss&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">row_best_model</span><span class="p">[</span><span class="s1">&#39;loss&#39;</span><span class="p">]</span>
    <span class="n">df_best_model</span><span class="p">[</span><span class="s1">&#39;best_model_val_loss&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">row_best_model</span><span class="p">[</span><span class="s1">&#39;val_loss&#39;</span><span class="p">]</span>
    <span class="n">df_best_model</span><span class="p">[</span><span class="s1">&#39;best_model_train_acc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">row_best_model</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">]</span>
    <span class="n">df_best_model</span><span class="p">[</span><span class="s1">&#39;best_model_val_acc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">row_best_model</span><span class="p">[</span><span class="s1">&#39;val_accuracy&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">lr</span><span class="p">:</span>
        <span class="n">df_best_model</span><span class="p">[</span><span class="s1">&#39;best_model_learning_rate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">row_best_model</span><span class="p">[</span><span class="s1">&#39;lr&#39;</span><span class="p">]</span>
    <span class="n">df_best_model</span><span class="p">[</span><span class="s1">&#39;best_model_nb_epoch&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">index_best_model</span>

    <span class="n">df_best_model</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">output_directory</span> <span class="o">+</span> <span class="s1">&#39;df_best_model.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># for FCN there is no hyperparameters fine tuning - everything is static in code</span>

    <span class="c1"># plot losses</span>
    <span class="n">plot_epochs_metric</span><span class="p">(</span><span class="n">hist</span><span class="p">,</span> <span class="n">output_directory</span> <span class="o">+</span> <span class="s1">&#39;epochs_loss.png&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df_metrics</span></div>


<div class="viewcode-block" id="evaluate"><a class="viewcode-back" href="../../Algorithms.html#Algorithms.Evaluate.evaluate">[docs]</a><span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">scaler</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">NAME_PROJECT</span><span class="p">,</span> <span class="n">play</span><span class="p">,</span> <span class="n">project</span><span class="p">,</span> <span class="n">CTGAN</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>  <span class="c1"># name = after / before</span>
    <span class="kn">import</span> <span class="nn">torch</span>
    <span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">&quot;cuda:0&quot;</span> <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">CTGAN</span><span class="p">:</span>
        <span class="n">X_test_transformer</span> <span class="o">=</span> <span class="n">CTGAN</span><span class="o">.</span><span class="n">_transformer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">scaler</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">X_test_scaler</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">X_test_scaler</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
        <span class="n">X_test_transformer</span> <span class="o">=</span> <span class="n">X_test_scaler</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">pred</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_transformer</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">real_fake</span><span class="p">,</span> <span class="n">pred</span> <span class="o">=</span> <span class="n">pred</span>
    <span class="k">except</span><span class="p">:</span>  <span class="c1"># for pytorch</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">D</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>  <span class="c1"># for dropout</span>
            <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
                <span class="n">pred</span> <span class="o">=</span> <span class="n">D</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">X_test_transformer</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">())</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="n">real_fake</span><span class="p">,</span> <span class="n">pred</span> <span class="o">=</span> <span class="n">pred</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">D</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
            <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
                <span class="n">pred</span> <span class="o">=</span> <span class="n">D</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">X_test_transformer</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">())</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="n">real_fake</span><span class="p">,</span> <span class="n">pred</span> <span class="o">=</span> <span class="n">pred</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">predictions_proba</span> <span class="o">=</span> <span class="n">pred</span><span class="p">[</span><span class="mi">0</span><span class="p">][:,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">predictions_proba</span> <span class="o">=</span> <span class="n">pred</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">predictions_proba</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">threshold</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">scores</span> <span class="o">=</span> <span class="n">evaluate_on_test</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predictions</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">predictions_proba</span><span class="o">.</span><span class="n">cpu</span><span class="p">(),</span> <span class="n">tensor</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">NAME_PROJECT</span><span class="p">,</span> <span class="s2">&quot;Results&quot;</span><span class="p">,</span> <span class="s2">&quot;D&quot;</span><span class="p">,</span> <span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;_train_scores.json&quot;</span><span class="p">),</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
    <span class="n">scores_play</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">play</span><span class="p">:</span>
        <span class="c1"># predictions = np.where(predictions_proba.cpu() &lt; threshold, 0, 1)</span>
        <span class="n">X_play</span><span class="p">,</span> <span class="n">new_y_true</span> <span class="o">=</span> <span class="n">Play</span><span class="o">.</span><span class="n">play_game</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">predictions</span><span class="p">,</span> <span class="n">NAME_PROJECT</span><span class="p">,</span> <span class="n">D</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">CTGAN</span><span class="p">:</span>
            <span class="n">X_play_transformer</span> <span class="o">=</span> <span class="n">CTGAN</span><span class="o">.</span><span class="n">_transformer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_play</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">scaler</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">X_play_transformer</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_play</span><span class="p">))</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">pred</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_play_transformer</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>  <span class="c1"># for pytorch</span>
            <span class="kn">import</span> <span class="nn">torch</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">D</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
                <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
                    <span class="n">pred</span> <span class="o">=</span> <span class="n">D</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">X_play_transformer</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">())</span><span class="o">.</span><span class="n">float</span><span class="p">())</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                    <span class="n">real_fake</span><span class="p">,</span> <span class="n">pred</span> <span class="o">=</span> <span class="n">pred</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">D</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
                    <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
                        <span class="n">pred</span> <span class="o">=</span> <span class="n">D</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">X_play_transformer</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">())</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                        <span class="n">real_fake</span><span class="p">,</span> <span class="n">pred</span> <span class="o">=</span> <span class="n">pred</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">D</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
                    <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
                        <span class="n">pred</span> <span class="o">=</span> <span class="n">D</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">X_play_transformer</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">())</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                        <span class="n">real_fake</span><span class="p">,</span> <span class="n">pred</span> <span class="o">=</span> <span class="n">pred</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">predictions_proba</span> <span class="o">=</span> <span class="n">pred</span><span class="p">[</span><span class="mi">0</span><span class="p">][:,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">predictions_proba</span> <span class="o">=</span> <span class="n">pred</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>

        <span class="n">predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">predictions_proba</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">threshold</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">scores_play</span> <span class="o">=</span> <span class="n">evaluate_on_test</span><span class="p">(</span><span class="n">new_y_true</span><span class="p">,</span> <span class="n">predictions</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">predictions_proba</span><span class="o">.</span><span class="n">cpu</span><span class="p">(),</span> <span class="n">tensor</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">NAME_PROJECT</span><span class="p">,</span> <span class="s2">&quot;Results&quot;</span><span class="p">,</span> <span class="s2">&quot;D&quot;</span><span class="p">,</span> <span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;_train_play_scores.json&quot;</span><span class="p">),</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">scores_play</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">scores</span><span class="p">,</span> <span class="n">scores_play</span></div>


<div class="viewcode-block" id="pca_"><a class="viewcode-back" href="../../Algorithms.html#Algorithms.Evaluate.pca_">[docs]</a><span class="k">def</span> <span class="nf">pca_</span><span class="p">(</span><span class="n">real</span><span class="p">,</span> <span class="n">fake</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
    <span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">pca</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">real</span><span class="p">)</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">real</span><span class="p">,</span> <span class="p">)</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">fake</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">a</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">a</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;real&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">b</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">b</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;fake&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


<div class="viewcode-block" id="visualization"><a class="viewcode-back" href="../../Algorithms.html#Algorithms.Evaluate.visualization">[docs]</a><span class="k">def</span> <span class="nf">visualization</span><span class="p">(</span><span class="n">train_bug</span><span class="p">,</span> <span class="n">train_not_bug</span><span class="p">,</span> <span class="n">G_bug</span><span class="p">,</span> <span class="n">G_not_bug</span><span class="p">,</span> <span class="n">project</span><span class="p">):</span>
    <span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
    <span class="n">list_G_bug</span> <span class="o">=</span> <span class="n">TSNE</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">G_bug</span><span class="p">)</span>
    <span class="n">list_train_bug</span> <span class="o">=</span> <span class="n">TSNE</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">train_bug</span><span class="p">)</span>
    <span class="n">list_G_not_bug</span> <span class="o">=</span> <span class="n">TSNE</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">train_not_bug</span><span class="p">)</span>
    <span class="n">list_train_not_bug</span> <span class="o">=</span> <span class="n">TSNE</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">G_not_bug</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">list_G_bug</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">list_G_bug</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;G bug&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">list_train_bug</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">list_train_bug</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;real bug&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">project</span><span class="si">}</span><span class="s2"> BUG&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;../Data/&quot;</span> <span class="o">+</span> <span class="n">project</span> <span class="o">+</span> <span class="s2">&quot;/Results/Visualization/scatter_bug.png&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">list_G_not_bug</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">list_G_not_bug</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;G not bug&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">list_train_not_bug</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">list_train_not_bug</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;real not bug&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">project</span><span class="si">}</span><span class="s2"> not bug&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;../Data/&quot;</span> <span class="o">+</span> <span class="n">project</span> <span class="o">+</span> <span class="s2">&quot;/Results/Visualization/scatter_not_bug.png&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span></div>


<div class="viewcode-block" id="read_data"><a class="viewcode-back" href="../../Algorithms.html#Algorithms.Evaluate.read_data">[docs]</a><span class="k">def</span> <span class="nf">read_data</span><span class="p">():</span>
    <span class="k">def</span> <span class="nf">read_help</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">NAME_PROJECT</span> <span class="o">+</span> <span class="s1">&#39;/train_test/&#39;</span> <span class="o">+</span> <span class="n">path</span><span class="p">)</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span>
        <span class="n">y_train</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;commit insert bug?&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">df</span><span class="p">,</span> <span class="n">y_train</span>

    <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="n">read_help</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;train_</span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s2">.csv&quot;</span><span class="p">)</span>  <span class="c1"># TODO: _current</span>
    <span class="k">return</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span></div>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">projects</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;cayenne&#39;</span><span class="p">,</span> <span class="s1">&#39;kylin&#39;</span><span class="p">,</span> <span class="s1">&#39;jspwiki&#39;</span><span class="p">,</span> <span class="s1">&#39;manifoldcf&#39;</span><span class="p">,</span> <span class="s1">&#39;commons-lang&#39;</span><span class="p">,</span> <span class="s1">&#39;tika&#39;</span><span class="p">,</span> <span class="s1">&#39;kafka&#39;</span><span class="p">,</span>
                <span class="s1">&#39;zookeeper&#39;</span><span class="p">,</span> <span class="s1">&#39;zeppelin&#39;</span><span class="p">,</span> <span class="s1">&#39;shiro&#39;</span><span class="p">,</span> <span class="s1">&#39;logging-log4j2&#39;</span><span class="p">,</span> <span class="s1">&#39;activemq-artemis&#39;</span><span class="p">,</span> <span class="s1">&#39;shindig&#39;</span><span class="p">,</span>
                <span class="s1">&#39;directory-studio&#39;</span><span class="p">,</span> <span class="s1">&#39;tapestry-5&#39;</span><span class="p">,</span> <span class="s1">&#39;openjpa&#39;</span><span class="p">,</span> <span class="s1">&#39;knox&#39;</span><span class="p">,</span> <span class="s1">&#39;commons-configuration&#39;</span><span class="p">,</span> <span class="s1">&#39;xmlgraphics-batik&#39;</span><span class="p">,</span>
                <span class="s1">&#39;mahout&#39;</span><span class="p">,</span> <span class="s1">&#39;deltaspike&#39;</span><span class="p">,</span> <span class="s1">&#39;openwebbeans&#39;</span><span class="p">,</span> <span class="s2">&quot;commons-collections&quot;</span><span class="p">]</span>
    <span class="c1"># TODO: visualization</span>
    <span class="c1"># for project in projects:</span>
    <span class="c1">#     try:</span>
    <span class="c1">#         NAME_PROJECT = f&quot;../Data/{project}&quot;</span>
    <span class="c1">#         p = project</span>
    <span class="c1">#         X_train, y_train = read_data()</span>
    <span class="c1">#         X = np.expand_dims(X_train, axis=-1)</span>
    <span class="c1">#         Y = np.expand_dims(y_train, axis=1)</span>
    <span class="c1">#         x_zero_only = X[np.where(Y == [0])[0]]</span>
    <span class="c1">#         y_zero_only = Y[np.where(Y == [0])[0]]</span>
    <span class="c1">#         x_one_only = X[np.where(Y == [1])[0]]</span>
    <span class="c1">#         y_one_only = Y[np.where(Y == [1])[0]]</span>
    <span class="c1">#</span>
    <span class="c1">#         data = pd.read_csv(os.path.join(NAME_PROJECT, &quot;train_test&quot;, f&quot;new_fake_data_{p}_bug_1000_512.csv&quot;))</span>
    <span class="c1">#         data = data.iloc[:, 1:]</span>
    <span class="c1">#         data.pop(&#39;commit insert bug?&#39;)</span>
    <span class="c1">#         data_nbug = pd.read_csv(os.path.join(NAME_PROJECT, &quot;train_test&quot;, f&quot;new_fake_data_{p}_nbug_500_512.csv&quot;))</span>
    <span class="c1">#         data_nbug = data_nbug.iloc[:, 1:]</span>
    <span class="c1">#         data_nbug.pop(&#39;commit insert bug?&#39;)</span>
    <span class="c1">#</span>
    <span class="c1">#         visualization(x_one_only[:,:,0], x_zero_only[:,:,0], data, data_nbug, project)</span>
    <span class="c1">#     except Exception as e:</span>
    <span class="c1">#         print(e)</span>

    <span class="c1"># average = [[], [], [], [], [], []]</span>
    <span class="c1"># for project in projects:</span>
    <span class="c1">#     try:</span>
    <span class="c1">#         # variable.projects</span>
    <span class="c1">#         NAME_PROJECT = &quot;../Data/&quot; + project</span>
    <span class="c1">#         # plot(&#39;94&#39;)</span>
    <span class="c1">#         plot_old(&quot;133&quot;)</span>
    <span class="c1">#     except Exception as e:</span>
    <span class="c1">#         print(e)</span>
    <span class="c1">#         pass</span>
    <span class="c1"># project = &quot;all&quot;</span>
    <span class="c1"># s = pd.concat([i for i in average[0]], axis=1)</span>
    <span class="c1"># s = s.groupby(s.columns.values, axis=1).mean()</span>
    <span class="c1"># show_plot([s[1], s[3]], [&#39;real&#39;, &#39;fake&#39;], &quot;loss D predict&quot;) # TODO: need change index after 118</span>
    <span class="c1"># show_plot([s[2], s[4]], [&#39;real&#39;, &#39;fake&#39;], &quot;loss D validation&quot;)</span>
    <span class="c1">#</span>
    <span class="c1"># g_loss_bug = pd.concat([i for i in average[2]], axis=1)</span>
    <span class="c1"># g_loss_bug = g_loss_bug.groupby(g_loss_bug.columns.values, axis=1).mean()</span>
    <span class="c1">#</span>
    <span class="c1"># g_loss_nb = pd.concat([i for i in average[1]], axis=1)</span>
    <span class="c1"># g_loss_nb = g_loss_nb.groupby(g_loss_nb.columns.values, axis=1).mean()</span>
    <span class="c1">#</span>
    <span class="c1"># show_plot([g_loss_nb[1], g_loss_bug[1],  s[4]], [&quot;not bug G&quot;, &quot;bug G&quot;, &quot;real&quot;], &quot;validation&quot;)</span>
    <span class="c1"># show_plot([g_loss_nb[2], g_loss_bug[2]], [&quot;not bug G&quot;, &quot;bug G&quot;], &quot;G loss predict&quot;)</span>
</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">SeC-GAN</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, Shir Cohen.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>